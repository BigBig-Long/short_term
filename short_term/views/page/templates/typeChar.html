<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>房屋类型分析</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Premium Multipurpose Admin & Dashboard Template" name="description">
    <meta content="Themesdesign" name="author">
    <meta name="referrer" content="no-referrer"/>

    <link href="/static/css/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css">
    <link href="/static/css/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css">
    <link href="/static/css/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css">
    <link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/static/css/icons.min.css" rel="stylesheet" type="text/css">
    <link href="/static/css/app.min.css" rel="stylesheet" type="text/css">

</head>

<body data-topbar="colored">

<!-- Begin page -->
<div id="layout-wrapper">

    <header id="page-topbar">
        <div class="navbar-header">
            <div class="d-flex">
                <!-- LOGO -->
                <div class="navbar-brand-box">
                    <a href="#" class="logo logo-dark" style="font-size:20px;font-weight: bold">
                        房屋数据分析预测系统
                    </a>

                    <a href="" class="logo logo-light">
                                <span class="logo-sm">
                                    <img src="/picture/logo-sm-light.png" alt="" height="22">
                                </span>
                        <span class="logo-lg">
                                    <img src="/picture/logo-light.png" alt="" height="20">
                                </span>
                    </a>
                </div>

                <button type="button" class="btn btn-sm px-3 font-size-24 header-item waves-effect"
                        id="vertical-menu-btn">
                    <i class="mdi mdi-backburger"></i>
                </button>

                <!-- App Search-->
                <form class="app-search d-none d-lg-block">
                    <div class="position-relative">
                        <input onclick="toSearch()" type="text" class="form-control" placeholder="Search...">
                        <span class="mdi mdi-magnify"></span>
                        <script>
                            const toSearch = () => {
                                window.location.href = 'http://localhost:5000/page/search'
                            }
                        </script>
                    </div>
                </form>
            </div>

            <div class="d-flex">

                <div class="dropdown d-inline-block">
                    <button type="button" class="btn header-item waves-effect" id="page-header-user-dropdown"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="d-none d-sm-inline-block ml-1">{{ username }}</span>
                        <i class="mdi mdi-chevron-down d-none d-sm-inline-block"></i>
                    </button>
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="/user/logOut"><i
                                class="mdi mdi-logout font-size-16 align-middle mr-1"></i> 退出登录</a>
                    </div>
                </div>

            </div>
        </div>

    </header>

    <!-- ========== Left Sidebar Start ========== -->
    <div class="vertical-menu">

        <div data-simplebar="" class="h-100">

            <!--- Sidemenu -->
            <div id="sidebar-menu">
                <!-- Left Menu Start -->
                <ul class="metismenu list-unstyled" id="side-menu">
                    <li class="menu-title">首页菜单</li>

                    <li>
                        <a href="/page/home" class="waves-effect">
                            <div class="d-inline-block icons-sm mr-1"><i class="uim uim-airplay"></i></div>
                            <span>首页</span>
                        </a>
                    </li>

                    <li>
                        <a href="/page/search" class=" waves-effect">
                            <div class="d-inline-block icons-sm mr-1"><i class="uim uim-schedule"></i></div>
                            <span>搜索分类</span>
                        </a>
                    </li>

                    <li>
                        <a href="/page/tableData" class="waves-effect">
                            <div class="d-inline-block icons-sm mr-1"><i class="uim uim-comment-message"></i></div>
                            <span>数据操作</span>
                        </a>
                    </li>
                    <li class="menu-title">数据可视化</li>

                    <li>
                        <a href="/page/priceChar" class="waves-effect">
                            <div class="d-inline-block icons-sm mr-1"><i class="uim uim-sign-in-alt"></i></div>
                            <span>房屋价格分析</span>
                        </a>
                    </li>

                    <li>
                        <a href="/page/detailChar" class="waves-effect">
                            <div class="d-inline-block icons-sm mr-1"><i class="uim uim-grids"></i></div>
                            <span>房屋详情分析</span>
                        </a>
                    </li>


                    <li>
                        <a href="/page/typeChar" class="waves-effect">
                            <div class="d-inline-block icons-sm mr-1"><i class="uim uim-box"></i></div>
                            <span>房屋类型分析</span>
                        </a>
                    </li>

                    <li>
                        <a href="/page/anthorChar" class="waves-effect">
                            <div class="d-inline-block icons-sm mr-1"><i class="uim uim-layer-group"></i></div>
                            <span>房屋状态分析</span>
                        </a>
                    </li>
                    <li class="menu-title">词云图</li>
                    <li>
                        <a href="/page/companyCloud" class="waves-effect">
                            <div class="d-inline-block icons-sm mr-1"><i class="uim uim-object-ungroup"></i></div>
                            <span>公司词云图</span>
                        </a>
                    </li>

                    <li>
                        <a href="/page/tagCloud" class="waves-effect">
                            <div class="d-inline-block icons-sm mr-1"><i class="uim uim-table"></i></div>
                            <span>标签词云图</span>
                        </a>
                    </li>
                    <li class="menu-title">人工智能</li>

                    <li>
                        <a href="/page/pricePred" class="waves-effect">
                            <div class="d-inline-block icons-sm mr-1"><i class="uim uim-document-layout-left"></i></div>
                            <span>房价预测</span>
                        </a>
                    </li>


                </ul>

            </div>
            <!-- Sidebar -->
        </div>
    </div>
    <!-- Left Sidebar End -->

    <!-- ============================================================== -->
    <!-- Start right Content here -->
    <!-- ============================================================== -->
    <div class="main-content">

        <div class="page-content">

            <!-- Page-Title -->
            <div class="page-title-box">
                <div class="container-fluid">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h4 class="page-title mb-1">房屋类型分析</h4>
                            <ol class="breadcrumb m-0">
                                <li class="breadcrumb-item"><a href="javascript: void(0);">首页菜单</a></li>
                                <li class="breadcrumb-item active">房屋类型分析</li>
                            </ol>
                        </div>
                    </div>

                </div>
            </div>
            <!-- end page title end breadcrumb -->

            <div class="page-content-wrapper">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">

                                    <h4 class="header-title">城市选择</h4>
                                    <div class="form-group row">
                                        <label class="col-md-2 col-form-label">城市选择</label>
                                        <div class="col-md-10">
                                            <!-- 只保留onchange调用，不传递任何参数 -->
                                            <select onchange="changeCity()" name="defaultCity" class="form-control">
                                                {% for i in citiesList %}
                                                    {% if i == defaultCity %}
                                                        <option selected value="{{ i }}">{{ i }}</option>
                                                    {% else %}
                                                        <option value="{{ i }}">{{ i }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                            <script>
                                                function changeCity() { // 用function声明，避免箭头函数可能的作用域问题
                                                    // 直接通过name属性定位select（简单粗暴，必能找到）
                                                    const selectElement = document.querySelector('select[name="defaultCity"]');
                                                    // 强制获取value（此时select一定有选中项，value不可能为undefined）
                                                    const selectedCity = selectElement.value;
                                                    // 跳转逻辑
                                                    const timestamp = new Date().getTime();
                                                    window.location.href = '/page/typeChar?city=' + selectedCity + '&_t=' + timestamp;
                                                }
                                            </script>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> <!-- end col -->
                    </div> <!-- end row -->
                    <div class="row">
                        <div class="col-6">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title">{{ defaultCity }} - 房屋装修情况分析</h4>
                                    <div id="main" style="width: 100%;height:450px">

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="header-title">{{ defaultCity }} - 房屋类型分析</h4>
                                    <div id="mainTwo" style="width: 100%;height:450px">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> <!-- end row -->

                </div>
                <!-- end container-fluid -->
            </div>
            <!-- end page-content-wrapper -->
        </div>
        <!-- End Page-content -->


        <footer class="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-6">
                    </div>
                    <div class="col-sm-6">
                        <div class="text-sm-right d-none d-sm-block">
                            Copyright &copy; 2024<a target="_blank" href="#">链家网房屋数据分析预测系统</a>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    <!-- end main content-->

</div>
<!-- END layout-wrapper -->


<!-- Right bar overlay-->
<div class="rightbar-overlay"></div>

<!-- JAVASCRIPT -->
<script src="/static/echarts.min.js"></script>
<script>
    const chartDom = document.getElementById('main');
    const myChart = echarts.init(chartDom);
    let option;

    option = {
        title: {
            text: '装修情况占比',
            left: 'center'
        },
        tooltip: {
            trigger: 'item'
        },
        legend: {
            orient: 'vertical',
            left: 'left'
        },
        series: [
            {
                name: '装修情况个数',
                type: 'pie',
                radius: '50%',
                data: {{ typeCheOneData | tojson }},
                emphasis: {
                    itemStyle: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    };

    option && myChart.setOption(option);

</script>
<script>
    const chartDomTwo = document.getElementById('mainTwo');
    const myChartTwo = echarts.init(chartDomTwo);
    let optionTwo;

    optionTwo = {
        title: {
            text: '房屋类型占比',
            left: 'center'
        },
        tooltip: {
            trigger: 'item'
        },
        legend: {
            orient: 'vertical',
            left: 'left'
        },
        series: [
            {
                name: '房屋类型个数',
                type: 'pie',
                roseType: "radius",
                radius: ['40%', '55%'],
                data: {{ typeCheTwoData | tojson }},
                emphasis: {
                    itemStyle: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    };

    optionTwo && myChartTwo.setOption(optionTwo);

</script>
<script src="/static/js/jquery.min.js"></script>
<script src="/static/js/bootstrap.bundle.min.js"></script>
<script src="/static/js/metisMenu.min.js"></script>
<script src="/static/js/simplebar.min.js"></script>
<script src="/static/js/waves.min.js"></script>
<script src="/static/js/bundle.js"></script>
<script src="/static/js/jquery.dataTables.min.js"></script>
<script src="/static/js/dataTables.bootstrap4.min.js"></script>
<script src="/static/js/dataTables.buttons.min.js"></script>
<script src="/static/js/buttons.bootstrap4.min.js"></script>
<script src="/static/js/jszip.min.js"></script>
<script src="/static/js/buttons.html5.min.js"></script>
<script src="/static/js/buttons.print.min.js"></script>
<script src="/static/js/buttons.colVis.min.js"></script>
<script src="/static/js/dataTables.responsive.min.js"></script>
<script src="/static/js/responsive.bootstrap4.min.js"></script>
<script src="/static/js/datatables.init.js"></script>
<script src="/static/js/app.js"></script>

</body>
</html>
