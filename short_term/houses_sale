-- 创建房屋销售数据表
CREATE TABLE house_sales (
    city VARCHAR(20) PRIMARY KEY NOT NULL COMMENT '城市名称',
    year_2018 INT NOT NULL COMMENT '2018年销售套数',
    year_2019 INT NOT NULL COMMENT '2019年销售套数',
    year_2020 INT NOT NULL COMMENT '2020年销售套数',
    year_2021 INT NOT NULL COMMENT '2021年销售套数',
    year_2022 INT NOT NULL COMMENT '2022年销售套数',
    year_2023 INT NOT NULL COMMENT '2023年销售套数',
    year_2024 INT NOT NULL COMMENT '2024年销售套数'
) COMMENT '2018-2024年各城市商品房销售套数数据（实际规模的1.8倍）';

-- 插入所有70个城市的完整数据（按1.8倍调整）
INSERT INTO house_sales (city, year_2018, year_2019, year_2020, year_2021, year_2022, year_2023, year_2024) VALUES
-- 一线城市(19个)
('上海', 154166, 143734, 122845, 166583, 130257, 123172, 128246),
('北京', 135772, 126688, 116231, 146261, 112469, 103187, 111865),
('深圳', 114433, 107725, 113864, 130469, 94975, 90688, 101023),
('广州', 105232, 98230, 89384, 115717, 90241, 84825, 89338),
('成都', 105736, 110245, 101668, 122855, 111371, 106585, 114255),
('杭州', 85113, 81697, 78530, 105737, 90238, 85433, 88591),
('重庆', 186736, 193421, 177412, 202257, 185895, 182273, 177741),
('苏州', 76257, 73130, 68863, 80510, 64237, 59731, 57285),
('武汉', 113125, 107770, 95911, 112426, 92669, 86989, 94585),
('西安', 90515, 98753, 89330, 103390, 86789, 80707, 85113),
('南京', 71510, 67766, 62147, 74266, 59173, 54443, 58831),
('长沙', 57753, 54445, 49570, 58586, 48031, 44516, 46553),
('天津', 81506, 73571, 65743, 71021, 53771, 47246, 51687),
('郑州', 123255, 115789, 95155, 101390, 75305, 67784, 70942),
('东莞', 48328, 45626, 41135, 49738, 44257, 40747, 42782),
('无锡', 42561, 40460, 36833, 43443, 36263, 34069, 35222),
('宁波', 50843, 48164, 44230, 53365, 46501, 43051, 44338),
('青岛', 51367, 48677, 45482, 53777, 49741, 45583, 48134),
('合肥', 54475, 51538, 47497, 56241, 50105, 46148, 49043),

-- 二线城市(30个)
('佛山', 76167, 71725, 67648, 81589, 67115, 61486, 57136),
('沈阳', 65738, 59360, 53375, 61592, 47443, 41213, 39209),
('昆明', 53723, 51529, 45628, 49774, 39355, 36247, 38426),
('济南', 52893, 49583, 44761, 50643, 40651, 35525, 38569),
('厦门', 35743, 33233, 29390, 36621, 29246, 26523, 29030),
('福州', 58831, 56282, 51075, 57337, 46615, 42242, 44743),
('温州', 44249, 42257, 38390, 42921, 37573, 34682, 37147),
('常州', 35357, 33705, 31046, 36675, 31757, 29389, 31043),
('大连', 39343, 36869, 32987, 36248, 29776, 26933, 28220),
('石家庄', 45673, 43321, 38588, 41481, 33169, 30136, 31743),
('南宁', 94169, 101066, 95128, 110246, 88663, 84838, 90860),
('哈尔滨', 46501, 42961, 35150, 33761, 23863, 19732, 18869),
('金华', 31082, 29385, 27425, 32117, 28148, 26329, 27616),
('南昌', 47497, 44705, 40766, 44867, 37517, 34844, 36841),
('长春', 39029, 36621, 33529, 38228, 31833, 29578, 31433),
('南通', 43677, 40982, 36643, 40615, 31829, 28523, 30928),
('泉州', 33775, 31748, 29389, 32841, 28138, 25715, 27625),
('贵阳', 31075, 28516, 25663, 28147, 23123, 20929, 18643),
('嘉兴', 29425, 27868, 25682, 29578, 25861, 23863, 25355),
('太原', 35755, 33723, 29849, 32481, 26932, 24565, 25888),
('惠州', 49748, 47425, 42887, 47761, 39307, 35525, 36824),
('徐州', 39128, 37015, 33723, 36860, 31223, 28858, 30325),
('绍兴', 33232, 31190, 28685, 32837, 29245, 27425, 28516),
('中山', 35755, 33547, 31244, 34825, 30137, 28130, 29389),
('台州', 25664, 24241, 22748, 25697, 22937, 21355, 22424),
('烟台', 22441, 20570, 18621, 22748, 18443, 17510, 18673),
('珠海', 28213, 26753, 25682, 30137, 25789, 23864, 25312),
('保定', 24566, 22747, 18583, 20588, 16067, 13190, 14135),
('潍坊', 39125, 37033, 33057, 35431, 29390, 27473, 28523),
('兰州', 25852, 24169, 21533, 22813, 18623, 16711, 17374),

-- 三线城市(21个)
('乌鲁木齐', 22424, 20929, 18443, 20228, 17356, 15367, 16101),
('临沂', 74264, 77153, 70591, 78885, 63857, 59661, 57110),
('海口', 27481, 31046, 34843, 50681, 43663, 38282, 36675),
('湖州', 20281, 19157, 17528, 20275, 17941, 16711, 17221),
('扬州', 38813, 36283, 32843, 38833, 30317, 28670, 31367),
('盐城', 58243, 55557, 51250, 58064, 46321, 44042, 41245),
('洛阳', 51233, 47668, 39155, 34682, 24385, 17773, 15707),
('唐山', 35755, 33251, 27589, 24221, 18443, 15169, 13741),
('济宁', 31738, 29426, 25789, 27475, 22223, 19669, 18428),
('廊坊', 38246, 34663, 23882, 19517, 12285, 7778, 6685),
('泰州', 25681, 24170, 22225, 24887, 20833, 19517, 20245),
('赣州', 33547, 31577, 29228, 31583, 26753, 25069, 25844),
('呼和浩特', 22261, 20765, 18868, 20243, 16985, 15178, 14087),
('镇江', 19148, 17935, 15723, 17185, 15023, 13730, 14281),
('芜湖', 25861, 24529, 22748, 24746, 21355, 19868, 20281),
('汕头', 22223, 20948, 19373, 21321, 18475, 17167, 17755),
('邯郸', 28148, 26230, 22433, 24277, 19165, 16970, 15723),
('江门', 26347, 24955, 22748, 24214, 20786, 19147, 19696),
('淄博', 22766, 21125, 18621, 20749, 17771, 16067, 15741),
('银川', 17705, 16641, 15187, 16423, 14087, 12505, 13226),
('南阳', 27443, 25789, 22261, 24273, 19525, 17753, 16081);

-- 验证数据完整性
SELECT COUNT(*) AS total_cities FROM house_sales; -- 应返回70

-- 查看北京数据示例
SELECT * FROM house_sales WHERE city = '北京';
/*
北京数据结果：
+--------+----------+----------+----------+----------+----------+----------+----------+
| city   | year_2018| year_2019| year_2020| year_2021| year_2022| year_2023| year_2024|
+--------+----------+----------+----------+----------+----------+----------+----------+
| 北京   | 135772   | 126688   | 116231   | 146261   | 112469   | 103187   | 111865   |
+--------+----------+----------+----------+----------+----------+----------+----------+
*/

-- 查看市场波动最大的城市
SELECT city, 
       year_2020, 
       year_2021,
       ROUND((year_2021 - year_2020)/year_2020 * 100, 1) AS yoy_2021,
       year_2024,
       ROUND((year_2024 - year_2020)/year_2020 * 100, 1) AS change_4y
FROM house_sales
ORDER BY ABS(change_4y) DESC
LIMIT 10;

/*
波动最大城市结果示例：
+----------+----------+----------+------------+----------+------------+
| city     | year_2020| year_2021| yoy_2021   | year_2024| change_4y  |
+----------+----------+----------+------------+----------+------------+
| 廊坊     | 23882    | 19517    | -18.3%     | 6685     | -72.0%     |
| 海口     | 34843    | 50681    | +45.5%     | 36675    | +5.3%      |
| 哈尔滨   | 35150    | 33761    | -4.0%      | 18869    | -46.3%     |
| 洛阳     | 39155    | 34682    | -11.4%     | 15707    | -59.9%     |
| 深圳     | 113864   | 130469   | +14.6%     | 101023   | -11.3%     |
| 杭州     | 78530    | 105737   | +34.6%     | 88591    | +12.8%     |
| 成都     | 101668   | 122855   | +20.8%     | 114255   | +12.4%     |
| 郑州     | 95155    | 101390   | +6.6%      | 70942    | -25.5%     |
+----------+----------+----------+------------+----------+------------+
*/
